<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ADA511 0.1 Data science and data-driven engineering - 24&nbsp; The universal exchangeable-inference machine in action</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./making_decisions.html" rel="next">
<link href="./missing_parts.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="ada511styles.css">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./recap.html"><span class="green"><strong>Population inference</strong></span></a></li><li class="breadcrumb-item"><a href="./glass_application_R.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">[The universal exchangeable-inference machine in action]{.red}</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./ada511logo8_small.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ADA511 <span class="small grey">0.1</span> <br>Data science and data-driven engineering</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dear student<br> and aspiring data engineer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>An invitation</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Accept or discard?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic_decisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic decision problems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Inference I</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><span class="green">What is an inference?</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sentences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><span class="green">Sentences</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./truth_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><span class="green">Truth inference</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><span class="green">Probability inference</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1st_connection_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><span class="red">A first connection with machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><span class="yellow"><strong>Data I</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantities_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><span class="yellow">Quantities and data types</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantities_types_multi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><span class="yellow">Joint quantities and complex data types</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Inference II</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><span class="green">Probability distributions</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joint_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><span class="green">Joint probability distributions</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./marginal_conditional_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><span class="green">Marginal and conditional probabilities</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2nd_connection_ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><span class="red">A second connection with machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><span class="yellow"><strong>Data II</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./populations_variates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><span class="yellow">Populations and variates</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><span class="yellow">Statistics</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subpopulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><span class="yellow">Subpopulations and conditional frequencies</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><span class="yellow">Infinite populations and samples</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Population inference</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><span class="green">A general inference problem</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><span class="green">Inference and populations</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exchangeability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title"><span class="green">Exchangeability</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_exchangeability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title"><span class="green">Inference under exchangeability</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing_parts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">To be written</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glass_application_R.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title"><span class="red">The universal exchangeable-inference machine in action</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><span class="lightblue"><strong>Decision theory</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making_decisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title"><span class="lightblue">Making decisions</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text"><strong>Machine learning</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Machine learning - an introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decision_trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#example-population-and-data" id="toc-example-population-and-data" class="nav-link active" data-scroll-target="#example-population-and-data"><span class="header-section-number">24.1</span> Example population and data</a></li>
  <li><a href="#the-agents-initial-state-of-knowledge" id="toc-the-agents-initial-state-of-knowledge" class="nav-link" data-scroll-target="#the-agents-initial-state-of-knowledge"><span class="header-section-number">24.2</span> The agent’s initial state of knowledge</a>
  <ul class="collapse">
  <li><a href="#load-the-machines-apparatus" id="toc-load-the-machines-apparatus" class="nav-link" data-scroll-target="#load-the-machines-apparatus">Load the machine’s apparatus</a></li>
  <li><a href="#learning-the-background-information" id="toc-learning-the-background-information" class="nav-link" data-scroll-target="#learning-the-background-information">Learning the background information</a></li>
  <li><a href="#preliminary-inferences-about-the-population" id="toc-preliminary-inferences-about-the-population" class="nav-link" data-scroll-target="#preliminary-inferences-about-the-population">Preliminary inferences about the population</a></li>
  <li><a href="#preliminary-inferences-about-units" id="toc-preliminary-inferences-about-units" class="nav-link" data-scroll-target="#preliminary-inferences-about-units">Preliminary inferences about units</a></li>
  </ul></li>
  <li><a href="#the-agent-learns-from-data" id="toc-the-agent-learns-from-data" class="nav-link" data-scroll-target="#the-agent-learns-from-data"><span class="header-section-number">24.3</span> The agent learns from data</a>
  <ul class="collapse">
  <li><a href="#learning-from-the-sample-data" id="toc-learning-from-the-sample-data" class="nav-link" data-scroll-target="#learning-from-the-sample-data">Learning from the sample data</a></li>
  <li><a href="#inferences-about-the-population" id="toc-inferences-about-the-population" class="nav-link" data-scroll-target="#inferences-about-the-population">Inferences about the population</a></li>
  <li><a href="#inferences-about-units" id="toc-inferences-about-units" class="nav-link" data-scroll-target="#inferences-about-units">Inferences about units</a></li>
  </ul></li>
  <li><a href="#conditional-discriminative-or-supervised-learning-inferences" id="toc-conditional-discriminative-or-supervised-learning-inferences" class="nav-link" data-scroll-target="#conditional-discriminative-or-supervised-learning-inferences"><span class="header-section-number">24.4</span> Conditional, “discriminative” or “supervised-learning” inferences</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title"><span class="red">The universal exchangeable-inference machine in action</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="hidden">
<p><span class="math display">\[
\DeclarePairedDelimiters{\set}{\{}{\}}
\]</span></p>
</div>
<div class="hidden">

</div>
<p><span class="small">First let’s load some libraries and functions that we shall use in this example:</span></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">'code/universal_exch-inference_machine.R'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="example-population-and-data" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="example-population-and-data"><span class="header-section-number">24.1</span> Example population and data</h2>
<p>Consider the following population, which we consider to be exchangeable:</p>
<ul>
<li><p><span class="small"><em>Units</em>: glass fragments collected at particularly defined crime scenes.</span></p></li>
<li><p><span class="small"><em>Variates</em>:</span></p>
<ul>
<li><span class="small"><span class="math inline">\(\mathit{RI}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Refractive Index of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Na}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Natrium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Mg}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Magnesium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Al}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Aluminium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Si}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Silicon content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{K}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Potassium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Ca}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Calcium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Ba}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Barium content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Fe}\)</span>, ordinal, domain <span class="math inline">\(\set{1,\dotsc,4}\)</span>: Iron content of the fragment</span></li>
<li><span class="small"><span class="math inline">\(\mathit{Type}\)</span>, nominal, domain <span class="math inline">\(\set{\texttt{\small T1},\dotsc,\texttt{\small T7}}\)</span>: Type or origin of the glass fragment</span></li>
</ul>
<p><span class="small">The values for the <span class="math inline">\(\mathit{RI}\)</span> and content variates represent ranges of numeric values or percentages, which you can find in <a href="datasets/glass_metadata-4_lev.csv">this metadata file</a>. In the same file you also find the description of the glass types.</span></p></li>
</ul>
<p>We have a sample of 214 units from this population; their variate values are stored in <a href="datasets/glass_data-4_lev.csv">this data file</a>. Here are the first five units:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(<span class="fu">fread</span>(<span class="st">'datasets/glass_data-4_lev.csv'</span>), <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Id RI Na Mg Al Si K Ca Ba Fe Type
1:  1  2  2  4  2  3 1  2  1  1   T2
2:  2  2  1  3  2  3 1  2  1  1   T2
3:  3  2  2  4  2  2 1  2  1  1   T1
4:  4  1  2  2  2  3 1  2  1  1   T4
5:  5  2  2  3  2  3 1  2  1  1   T1</code></pre>
</div>
</div>
<p><br>
</p>
<p>Now we imagine to prepare an agent for drawing inferences about the full population of glass fragments – which also means fragments from <em>future</em> or <em>unsolved</em> crime scenes. The agent uses – or is the embodiment of – the universal exchangeable-inference machine.</p>
</section>
<section id="the-agents-initial-state-of-knowledge" class="level2 page-columns page-full" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="the-agents-initial-state-of-knowledge"><span class="header-section-number">24.2</span> The agent’s initial state of knowledge</h2>
<section id="load-the-machines-apparatus" class="level3">
<h3 class="anchored" data-anchor-id="load-the-machines-apparatus">Load the machine’s apparatus</h3>
<p>The call</p>
<pre><code>source('code/universal_exch-inference_machine.R')</code></pre>
<p>at the beginning of this chapter loaded several <code>R</code> functions that implement the universal machine: they draw inferences, calculate marginal and conditional probabilities, and plot probability distributions.</p>
</section>
<section id="learning-the-background-information" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="learning-the-background-information">Learning the background information</h3>
<p>Our agent at the moment doesn’t know anything at all, not even about the existence of the population above. If we were to ask it anything, we would just get a blank stare back.</p>
<p>Let us give it the basic background information about the population: the variates’ names and domains. We do this through the function <code>finfo()</code>: it has a <code>data</code> argument, which we omit for the moment, and a <code>metadata</code> argument. The latter can simply be the name of the file containing the metadata (NB: this file must have a specific format):</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>priorknowledge <span class="ot">&lt;-</span> <span class="fu">finfo</span>(<span class="at">metadata=</span><span class="st">'datasets/glass_metadata-4_lev.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full"><p>The agent now possesses this basic background knowlege, encoded in the <code>priorknowledge</code> object. The encoding uses a particular mathematical representation which, however, is of no interest to us<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Other representations could also be used, but the knowledge would be the same. Think of this as encoding an image into a <code>png</code> or other lossless format: the representation of the image would be different, but the image would be the same.</p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;If you’re curious you can have a glimpse at it with the command <code>str(priorknowledge)</code>, which displays structural information about an object.</p></li></div></div>
</section>
<section id="preliminary-inferences-about-the-population" class="level3">
<h3 class="anchored" data-anchor-id="preliminary-inferences-about-the-population">Preliminary inferences about the population</h3>
<p>Now the agent knows about the population, variates, and domains. But it has not seen any data, that is, the variate values for some units. Yet we can ask it some questions and to draw some inferences. Remember that <em>the answer to a question</em> is not just a value: it <em>is the collection of all possible values, with a probability assigned to each</em>. If the actual value is known, then it will have probability <code>1</code>, and all others probability <code>0</code>.</p>
<p>Let’s ask the agent: what is the marginal frequency distribution for the variate <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span>,</span> in the <em>full</em> (infinite!) population? Obviously the agent doesn’t know what the actual distribution is, nor do we. It will calculate a probability distribution over all possible marginal frequency distributions.</p>
<p>This probability distribution for the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> variate is calculated by the function <code>fmarginal()</code>. It has arguments <code>finfo</code>: the agent’s information; and <code>variates</code>: the names of the variates of which we want the marginal frequencies:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>priorknowledge_type <span class="ot">&lt;-</span> <span class="fu">fmarginal</span>(<span class="at">finfo=</span>priorknowledge, <span class="at">variates=</span><span class="st">'Type'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The answer is stored in the object <code>priorknowledge_type</code>, which now contains only information pertinent to the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> variate.</p>
<p>We would like to visualize this probability distribution over marginal frequency distributions. A complication is that we would need infinite dimensions to visualize this faithfully. One approximate way to represent this probability distribution is by showing, say, 100 representative samples from it. The idea is the same as for a scatter plot (<a href="probability_distributions.html#sec-represent-probs">§&nbsp;&nbsp;<span>11.5</span></a>). In this case we would then have 100 different frequency distributions for the variate <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span>.</span></p>
<p>The function <code>plotsamples1D()</code> does this kind of visual representation. It has arguments <code>finfo</code>: the object encoding the probability distribution; <code>n</code> (default 100): the number of samples to show; and <code>predict</code>, which for the moment we set to <code>FALSE</code> and discuss in a moment.</p>
<p>How do you think this probability distribution will look like? what kind of marginal frequencies we do expect in the full population?</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotsamples1D</span>(<span class="at">finfo=</span>priorknowledge_type, <span class="at">n=</span><span class="dv">100</span>, <span class="at">predict=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="glass_application_R_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>You see that anything goes: Some frequency distributions give frequency almost <code>1</code> to a specific value, and almost <code>0</code> to the others. Other frequency distributions spread out the frequencies more evenly, with some peaks here or there.</p>
<p>This is a meaningful answer, because the agent hasn’t seen any data. From its point of view, everything is possible in this population.</p>
<p>@@ TODO: add representation as quantiles</p>
</section>
<section id="preliminary-inferences-about-units" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="preliminary-inferences-about-units">Preliminary inferences about units</h3>
<p>Up to now the agent has drawn an inference regarding the full population, not regarding any specific unit. Now let’s ask it: what will be the value of the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> variate in the next unit, or glass fragment, we observe? As usual, an answer consists in a probability distribution over all possible values.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before continuing, ask yourself the same question: which probabilities would you give to the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> values for the next unit, given that you only know that this quantity has seven possible values?</p>
</div>
</div>
<p>The agent’s answer this time is a probability distribution over seven values, which we can draw faithfully. The function <code>plotsamples1D()</code> can draw this probability as well, if we give the argument <code>predict=TRUE</code> (default):</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotsamples1D</span>(<span class="at">finfo=</span>priorknowledge_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="glass_application_R_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="page-columns page-full"><p>This plot shows the <span class="blue">probability distribution</span> for the next unit in <span class="blue">blue</span>, together with a sample of 100 possible frequency distributions for the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> variate over the full population. Note that samples are drawn anew every time, so they can look somewhat differently from time to time.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;To have reproducible plots, use <code>set.seed(314)</code> (or any integer you like) before calling the plot function.</p></li></div></div>
<p>The agent’s answer is that in the next unit we can observe any <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> value with equal probability. Do you think this is a reasonable answer?</p>
<p>The plot above and the information it represents are very useful for inference purposes: not only they give the probability for the next observation, but also an idea of how such a probability could change in the future, as more data are collected and knowledge of the population’s frequency distribution becomes more precise.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Inspect the agent’s inferences for other variates.</p>
</div>
</div>
</section>
</section>
<section id="the-agent-learns-from-data" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="the-agent-learns-from-data"><span class="header-section-number">24.3</span> The agent learns from data</h2>
<section id="learning-from-the-sample-data" class="level3">
<h3 class="anchored" data-anchor-id="learning-from-the-sample-data">Learning from the sample data</h3>
<p>Now let’s give the agent the data from the sample of 214 glass fragments. This is done again with the <code>finfo()</code> function, but providing the <code>data</code> argument, which can be the name of the data file:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>postknowledge <span class="ot">&lt;-</span> <span class="fu">finfo</span>(<span class="at">data=</span><span class="st">'datasets/glass_data-4_lev.csv'</span>, <span class="at">metadata=</span><span class="st">'datasets/glass_metadata-4_lev.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>postknowledge</code> object contains the agent’s knowledge from the metadata and the sample data. This object can be used in the same way as the object representing the agent’s background knowledge.</p>
</section>
<section id="inferences-about-the-population" class="level3">
<h3 class="anchored" data-anchor-id="inferences-about-the-population">Inferences about the population</h3>
<p>Now that the agent has learned from the data, we can ask it again what is the marginal frequency distribution for the variate <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span>,</span> in the full population.</p>
<p>We calculate the probability for the possible marginal frequency distributions, and then plot it as a set of 100 representative samples:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>postknowledge_type <span class="ot">&lt;-</span> <span class="fu">fmarginal</span>(<span class="at">finfo=</span>postknowledge, <span class="at">variates=</span><span class="st">'Type'</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plotsamples1D</span>(<span class="at">finfo=</span>postknowledge_type, <span class="at">predict=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="glass_application_R_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>This plot shows two important aspects of this probability distribution and of the agent’s current state of knowledge:</p>
<ul>
<li><p>Not anything goes anymore. Some frequency distributions are clearly “excluded”, or more precisely they are <em>extremely</em> improbable. The most probable frequency distributions have a maximum at the <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T2}\)</span></span> value, another lower peak for the value <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T4}\)</span>,</span> and several other qualitative features that can be glimpsed from the plot.</p></li>
<li><p>Yet, the agent still has a degree of uncertainty, qualitatively shown by the width of the “bands” of frequency distributions. For example, the frequency for the <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T2}\)</span></span> value could be <span style="display:inline-block;"><span class="math inline">\(0.40\)</span></span> as well as <span style="display:inline-block;"><span class="math inline">\(0.30\)</span></span></p></li>
</ul>
<p>@@ TODO: add code with function that reports the exact probabilities of the frequencies.</p>
<p>And there are other more specific aspects that can be found by visual inspection. For instance:</p>
<ul>
<li><p>Some frequency distributions have their absolute maximum at <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T1}\)</span>,</span> and a lower value at <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T2}\)</span>.</span> Vice versa, others have their absolute maximum at <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T2}\)</span></span> and a lower value at <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T1}\)</span>.</span> So there’s still uncertainty as to which value is the most frequent in the full population.</p></li>
<li><p>The agent gives a very small but non-zero frequency to the value <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T7}\)</span>.</span> Yet, <em>the data have no units at all with the <span class="math inline">\(\texttt{\small T7}\)</span> value</em>. Even if the agent has never seen this value in the data it was given, it knows nevertheless, from the metadata, that this is a possible value. So the agent doesn’t dogmatically say that its frequency in the full population should be zero (as in the sample); only that it should be extremely low.</p></li>
</ul>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given that the value <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T7}\)</span></span> has not been observed in 214 units, what approximate upper bound to its frequency would you give? Does the agent’s inference agree with your intuition?</p>
</div>
</div>
</section>
<section id="inferences-about-units" class="level3">
<h3 class="anchored" data-anchor-id="inferences-about-units">Inferences about units</h3>
<p>Finally we ask the agent what <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> value we should observe in the next glass fragment. The probability distribution answering this question is plotted by the same function with the argument <code>predict=TRUE</code> (default), as before:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotsamples1D</span>(<span class="at">finfo=</span>postknowledge_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-unconditional-glass" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="glass_application_R_files/figure-html/fig-unconditional-glass-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;24.1: <span class="grey">Frequency distributions for full population</span>, and <span class="blue">probability distribution for next unit</span></figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conditional-discriminative-or-supervised-learning-inferences" class="level2 page-columns page-full" data-number="24.4">
<h2 data-number="24.4" class="anchored" data-anchor-id="conditional-discriminative-or-supervised-learning-inferences"><span class="header-section-number">24.4</span> Conditional, “discriminative” or “supervised-learning” inferences</h2>
<p>The inferences about a new units that the agent has made so far were of an “unsupervised-learning” or “generative” kind ([§&nbsp;sec-2nd-connection-ML]): the agent did not receive or use any partial information about a new unit. Let’s now try a “supervised-learning” or “discriminative” kind of inference.</p>
<p>Imagine that we are at a new crime scene, a glass fragment is recovered, and tests are made about its refractive index and chemical composition. The following values are found, referred to the levels of our variates:</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><img src="glass_crimescene.jpg" class="img-fluid" style="width:100.0%"></p>
</div></div><div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>newfragment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">RI=</span><span class="dv">2</span>, <span class="at">Na=</span><span class="dv">2</span>,  <span class="at">Mg=</span><span class="dv">3</span>,  <span class="at">Al=</span><span class="dv">2</span>,  <span class="at">Si=</span><span class="dv">3</span>,  <span class="at">K=</span><span class="dv">1</span>, <span class="at">Ca=</span><span class="dv">2</span>,  <span class="at">Ba=</span><span class="dv">1</span>,  <span class="at">Fe=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The detectives would like to know what’s the possible origin of this fragment, that is, its <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span>.</span> Our agent can draw this inference.</p>
<p>First, the agent can calculate the probability distribution over the <em>conditional frequencies</em> (<a href="subpopulations.html#sec-conditional-freqs">§&nbsp;&nbsp;<span>17.2</span></a>) of the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> values for the subpopulation (<a href="subpopulations.html#sec-subpopulations">§&nbsp;&nbsp;<span>17.1</span></a>) of units having the specific variate values above. This calculation is done with the function <code>fconditional()</code>, with arguments <code>finfo</code>: the agent’s current knowledge, and <code>unitdata</code>: the partial data obtained from the unit.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>condknowledge <span class="ot">&lt;-</span> <span class="fu">fconditional</span>(<span class="at">finfo=</span>postknowledge, <span class="at">unitdata=</span>newfragment)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>condknowledge_type <span class="ot">&lt;-</span> <span class="fu">fmarginal</span>(<span class="at">finfo=</span>condknowledge, <span class="at">variates=</span><span class="st">'Type'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>condknowledge</code> object contains the agent’s knowledge conditional on the variates given; this knowledge is about the remaining variates, which in this case are the single variate <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> (so the <code>fmarginal()</code> calculation is actually redundant in this case).</p>
<p>Second, the agent can calculate the probability distribution for the <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> values of this particular glass fragment, given the above information.</p>
<p>Both inferences can be visualized in the usual way:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotsamples1D</span>(<span class="at">finfo=</span>condknowledge_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-conditional-glass" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="glass_application_R_files/figure-html/fig-conditional-glass-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;24.2: <span class="grey">Conditional frequency distributions for full population</span>, and <span class="blue">conditional probability distribution for next unit</span></figcaption>
</figure>
</div>
</div>
</div>
<p>The agent thus gives a probability around <span style="display:inline-block;"><span class="math inline">\(80\%\)</span></span> to the fragment’s being of <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T1}\)</span></span> type, around <span style="display:inline-block;"><span class="math inline">\(10\%\)</span></span> of being <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T2}\)</span></span> type, and around <span style="display:inline-block;"><span class="math inline">\(5\%\)</span></span> of being <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T5}\)</span></span> type. It also shows that further training data could change these probabilities by even <span style="display:inline-block;"><span class="math inline">\(\pm 10\%\)</span></span> or even <span style="display:inline-block;"><span class="math inline">\(\pm 15\%\)</span>.</span></p>
<p>Note how the possible conditional frequency distributions for <span style="display:inline-block;"><span class="math inline">\(\mathit{Type}\)</span></span> and the probability distribution differ from the unconditional ones shown in <a href="#fig-unconditional-glass">fig.&nbsp;&nbsp;<span>24.1</span></a>. The global maximum, <span style="display:inline-block;"><span class="math inline">\(80\%\)</span>,</span> is now sharper than the one for the unconditional case, <span style="display:inline-block;"><span class="math inline">\(35\%\)</span>.</span> This means that knowledge of the other variates for the present fragment has decreased the agent’s uncertainty as regards its type.</p>
<p>Should the crime investigation proceed on the assumption that the fragment is of <span style="display:inline-block;"><span class="math inline">\(\texttt{\small T1}\)</span></span> type? No, not necessarily. The best decision depends on the gains and costs involved in making correct or wrong assumptions. To this last decision-making problem we turn next.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Perform the “discriminative” inferences above, but omitting from the <code>newfragment</code> data <em>one</em> variate in turn; so first omit only <span style="display:inline-block;"><span class="math inline">\(\mathit{RI}\)</span></span> and do the inferences, then omit only <span style="display:inline-block;"><span class="math inline">\(\mathit{Na}\)</span></span> and do the inferences, and so on.</p></li>
<li><p>In each of these inferences you will find that the agent becomes more ore less “confident” about the fragment type. Which of the variates above seem to be most important for making a confident inference?</p></li>
</ul>
</div>
</div>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./missing_parts.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">To be written</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./making_decisions.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title"><span class="lightblue">Making decisions</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>